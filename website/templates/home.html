{% extends "base.html" %}
{% block title %}Grades{% endblock %}
{% from "_render_field.html" import render_field, render_string_field %}

{% block content %}

<h1 class="mt-5 text-center">Texas A&M Grade Distribution</h1>
<br />
<div class="text-center border border-light p-5 mb-5">

    <ul class="nav nav-pills nav-fill mb-4" id="pills-tab" role="tablist">

        <li class="nav-item">
            <a class="nav-link {% if source == 'course' %} active {% endif %}" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab"
                aria-controls="pills-home" aria-selected="{% if source == 'course' %} true {% else%} false {% endif %}">Sort by Course <i class="fas fa-university"></i></a>
        </li>

        <li class="nav-item">
            <a class="nav-link {% if source == 'professor' %} active {% endif %}" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab"
                aria-controls="pills-profile" aria-selected="{% if source == 'professor' %} true {% else%} false {% endif %}">Sort by Professor <i class="fas fa-user-tie"></i></a>
        </li>
        
    </ul>

    <div class="tab-content pt-2 pl-1" id="pills-tabContent">

        <div class="tab-pane fade {% if source == 'course' %} show active {% endif %}" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
            <p class="h4 mb-4">Sort by college, year and semester</p>

            <p class="mb-5">Know which professors or courses to take and avoid!</p>

            <!-- College -->
            <form class="mt-5" method="GET" action="results" id="form_results">
            
                <!-- College -->
                <div class="form-group mx-3">{{ render_field(form.college, placeholder=form.college.label.text) }}</div>
            
            
            
                <div class="form-row">
                  <!-- Semester -->
                  <div class="form-group col-md mx-3 mt-3 mb-1">
                    {{ render_field(form.semester, placeholder=form.semester.label.text) }}
                  </div>
            
                  <!-- Year -->
                  <div class="form-group col-md mx-3 mt-3 mb-1">
                    {{ render_field(form.year, placeholder=form.year.label.text) }}
                  </div>
                </div>
            
                <!-- Send button -->
                <div class="form-group mb-1">
                    <button class="btn btn-info mt-4 px-auto" type="submit">Search</button>
                </div>

              </form>
        </div>

        <div class="tab-pane fade {% if source == 'professor' %} show active {% endif %}" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
            <p class="h4 mb-4">Sort by professors</p>

            <p class="mb-5">Know which professors to take and avoid!</p>

            <!-- Professor -->
            <form method="GET" class="needs-validation" action="professors" novalidate>

                <div class="row">
                    <div class="col-md-6 offset-md-3">
                            <div class="form-group mx-3">{{ render_string_field(form.professor,
                                placeholder=form.professor.label.text) }}</div>
                            <div class="invalid-feedback">This field is required.</div>
                    </div>
                </div>
                
                <!-- Send button -->
                <div class="form-group mb-1">
                    <button class="btn btn-info mt-4 px-auto" type="submit">Search</button>
                </div>

        </div>
    </div>
</div>

{% if grade_results == None %}
    <!-- <p>use the above form to get data</p> -->
{% else %}
    {% if grade_results|length == 0 %}
        <h1 class="text-center">No results.</h1>
    {% else %}
    <table id="dtBasicExample" class="table table-striped table-bordered table-sm" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th class="th-sm">Department</th>
                <th class="th-sm">Course / Section</th>
                <th class="th-sm">A</th>
                <th class="th-sm">B</th>
                <th class="th-sm">C</th>
                <th class="th-sm">D</th>
                <th class="th-sm">F</th>
                <th class="th-sm">GPA</th>
                <th class="th-sm">Instructor</th>
            </tr>
        </thead>
        <tbody>
            {% for grade in grade_results %}
            <tr>
                <td>{{ grade.department }}</td>
                <td>{{ grade.course }} - {{ grade.section }}</td>
                <td>{{ grade.amount_A }} <div class="text-muted">({{ "%.2f"|format(grade.percent_A) }}%)</div>
                </td>
                <td>{{ grade.amount_B }} <div class="text-muted">({{ "%.2f"|format(grade.percent_B) }})%</div>
                </td>
                <td>{{ grade.amount_C }} <div class="text-muted">({{ "%.2f"|format(grade.percent_C) }})%</div>
                </td>
                <td>{{ grade.amount_D }} <div class="text-muted">({{ "%.2f"|format(grade.percent_D) }})%</div>
                </td>
                <td>{{ grade.amount_F }} <div class="text-muted">({{ "%.2f"|format(grade.percent_F) }})%</div>
                </td>
                <td>{{ "%.3f"|format(grade.gpa) }}</td>
                <td>{{ grade.instructor }}</td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <th>Department</th>
                <th>Course</th>
                <th>Section</th>
                <th>A</th>
                <th>B</th>
                <th>C</th>
                <th>D</th>
                <th>F</th>
            </tr>
        </tfoot>
    </table>
    {% endif %}
{% endif %}
<br/>


<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>


<a type="button" data-toggle="modal" data-target="#centralModalInfo">Launch
    modal
</a>
 
  <!-- Central Modal Medium Info -->
  <div class="modal fade" id="centralModalInfo" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg modal-notify modal-info" role="document">
      <!--Content-->
      <div class="modal-content">
        <!--Header-->
        <div class="modal-header">
          <p class="heading lead">Modal Info</p>
 
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true" class="white-text">&times;</span>
          </button>
        </div>
 
        <!--Body-->
        <div class="modal-body" >
            <script type="text/javascript">
                google.charts.load("current", {packages:["corechart"]});
                google.charts.setOnLoadCallback(drawChart);
                function drawChart() {
                  var data = google.visualization.arrayToDataTable([
                    ['Task', 'Hours per Day'],
                    ['Work',     11],
                    ['Eat',      2],
                    ['Commute',  2],
                    ['Watch TV', 2],
                    ['Sleep',    7]
                  ]);
          
                  var options = {
                    title: 'My Daily Activities',
                    width: 800,
                    height: 400
                  };
          
                  var chart = new google.visualization.PieChart(document.getElementById('piechart'));
                  chart.draw(data, options);
                }
              </script>
            <div id="piechart" style="width: 900px; height: 500px;"></div>

        </div>
 
        <!--Footer-->
        <div class="modal-footer justify-content-center">
          <a type="button" class="btn btn-primary">Get it now <i class="far fa-gem ml-1 text-white"></i></a>
          <a type="button" class="btn btn-outline-primary waves-effect" data-dismiss="modal">No, thanks</a>
        </div>
      </div>
      <!--/.Content-->
    </div>
  </div>
  <!-- Central Modal Medium Info-->



{% endblock %}

